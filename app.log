DEBUG: Set display.max_colwidth to None
DEBUG: Suppressing matplotlib font manager logger
INFO: Creating new transition matrix at: data/processed/od_early_transition_matrix.csv
WARNING: on_demand alive_wo_arthropathy row sum 1.4785 > 1, normalizing
DEBUG: on_demand minor_bleeding row sum 0.9541 < 1, adding to alive_wo_arthropathy
DEBUG: on_demand articular_bleeding row sum 0.9546 < 1, adding to alive_wo_arthropathy
DEBUG: on_demand life_treating_bleeding row sum 0.9542 < 1, adding to alive_wo_arthropathy
DEBUG: on_demand surgery row sum 0.9541 < 1, adding to alive_wo_arthropathy
DEBUG: on_demand inhibitor row sum 0.0000 < 1, adding to inhibitor
WARNING: on_demand chronic_arthropathy row sum 1.4781 > 1, normalizing
DEBUG: on_demand transition probabilities from alive_wo_arthropathy:
DEBUG:   To minor_bleeding: 0.1545
DEBUG:   To articular_bleeding: 0.7960
DEBUG:   To life_treating_bleeding: 0.0464
DEBUG:   To inhibitor: 0.0028
DEBUG:   To chronic_arthropathy: 0.0003
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from minor_bleeding:
DEBUG:   To alive_wo_arthropathy: 0.9959
DEBUG:   To inhibitor: 0.0041
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from articular_bleeding:
DEBUG:   To alive_wo_arthropathy: 0.9954
DEBUG:   To inhibitor: 0.0041
DEBUG:   To chronic_arthropathy: 0.0004
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from life_treating_bleeding:
DEBUG:   To alive_wo_arthropathy: 0.9958
DEBUG:   To inhibitor: 0.0041
DEBUG:   To death: 0.0000
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from surgery:
DEBUG:   To alive_wo_arthropathy: 0.9959
DEBUG:   To inhibitor: 0.0041
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from inhibitor:
DEBUG:   To inhibitor: 1.0000
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from death:
DEBUG:   To death: 1.0000
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from chronic_arthropathy:
DEBUG:   To minor_bleeding: 0.1546
DEBUG:   To articular_bleeding: 0.7963
DEBUG:   To life_treating_bleeding: 0.0464
DEBUG:   To inhibitor: 0.0028
DEBUG:   Row sum: 1.0000
INFO: Saving on_demand transition matrix
INFO: Starting Markov chain simulation for on_demand early
INFO: Using 4 processes for on_demand early simulations
INFO: Total simulation time for on_demand early: 7.55 seconds
DEBUG: on_demand run: 139 bleed transitions, 109 joint bleed transitions, ABR=1.90, AJBR=1.49
DEBUG: on_demand run: 139 bleed transitions, 109 joint bleed transitions, ABR=1.90, AJBR=1.49
DEBUG: on_demand run: 139 bleed transitions, 109 joint bleed transitions, ABR=1.90, AJBR=1.49
DEBUG: on_demand run: 139 bleed transitions, 109 joint bleed transitions, ABR=1.90, AJBR=1.49
DEBUG: on_demand run: 390 bleed transitions, 319 joint bleed transitions, ABR=5.34, AJBR=4.37
DEBUG: on_demand run: 390 bleed transitions, 319 joint bleed transitions, ABR=5.34, AJBR=4.37
DEBUG: on_demand run: 390 bleed transitions, 319 joint bleed transitions, ABR=5.34, AJBR=4.37
DEBUG: on_demand run: 390 bleed transitions, 319 joint bleed transitions, ABR=5.34, AJBR=4.37
DEBUG: on_demand run: 85 bleed transitions, 68 joint bleed transitions, ABR=1.16, AJBR=0.93
DEBUG: on_demand run: 85 bleed transitions, 68 joint bleed transitions, ABR=1.16, AJBR=0.93
DEBUG: on_demand run: 85 bleed transitions, 68 joint bleed transitions, ABR=1.16, AJBR=0.93
DEBUG: on_demand run: 85 bleed transitions, 68 joint bleed transitions, ABR=1.16, AJBR=0.93
DEBUG: on_demand run: 13 bleed transitions, 11 joint bleed transitions, ABR=0.18, AJBR=0.15
DEBUG: on_demand run: 13 bleed transitions, 11 joint bleed transitions, ABR=0.18, AJBR=0.15
DEBUG: on_demand run: 13 bleed transitions, 11 joint bleed transitions, ABR=0.18, AJBR=0.15
DEBUG: on_demand run: 13 bleed transitions, 11 joint bleed transitions, ABR=0.18, AJBR=0.15
DEBUG: on_demand run: 46 bleed transitions, 37 joint bleed transitions, ABR=0.63, AJBR=0.51
DEBUG: on_demand run: 46 bleed transitions, 37 joint bleed transitions, ABR=0.63, AJBR=0.51
DEBUG: on_demand run: 46 bleed transitions, 37 joint bleed transitions, ABR=0.63, AJBR=0.51
DEBUG: on_demand run: 46 bleed transitions, 37 joint bleed transitions, ABR=0.63, AJBR=0.51
DEBUG: on_demand run: 363 bleed transitions, 271 joint bleed transitions, ABR=4.97, AJBR=3.71
DEBUG: on_demand run: 363 bleed transitions, 271 joint bleed transitions, ABR=4.97, AJBR=3.71
DEBUG: on_demand run: 363 bleed transitions, 271 joint bleed transitions, ABR=4.97, AJBR=3.71
DEBUG: on_demand run: 363 bleed transitions, 271 joint bleed transitions, ABR=4.97, AJBR=3.71
DEBUG: on_demand run: 10 bleed transitions, 8 joint bleed transitions, ABR=0.14, AJBR=0.11
DEBUG: on_demand run: 10 bleed transitions, 8 joint bleed transitions, ABR=0.14, AJBR=0.11
DEBUG: on_demand run: 10 bleed transitions, 8 joint bleed transitions, ABR=0.14, AJBR=0.11
DEBUG: on_demand run: 10 bleed transitions, 8 joint bleed transitions, ABR=0.14, AJBR=0.11
DEBUG: on_demand run: 154 bleed transitions, 131 joint bleed transitions, ABR=2.11, AJBR=1.79
DEBUG: on_demand run: 154 bleed transitions, 131 joint bleed transitions, ABR=2.11, AJBR=1.79
DEBUG: on_demand run: 154 bleed transitions, 131 joint bleed transitions, ABR=2.11, AJBR=1.79
DEBUG: on_demand run: 154 bleed transitions, 131 joint bleed transitions, ABR=2.11, AJBR=1.79
DEBUG: on_demand run: 24 bleed transitions, 19 joint bleed transitions, ABR=0.33, AJBR=0.26
DEBUG: on_demand run: 24 bleed transitions, 19 joint bleed transitions, ABR=0.33, AJBR=0.26
DEBUG: on_demand run: 24 bleed transitions, 19 joint bleed transitions, ABR=0.33, AJBR=0.26
DEBUG: on_demand run: 24 bleed transitions, 19 joint bleed transitions, ABR=0.33, AJBR=0.26
DEBUG: on_demand run: 122 bleed transitions, 92 joint bleed transitions, ABR=1.67, AJBR=1.26
DEBUG: on_demand run: 122 bleed transitions, 92 joint bleed transitions, ABR=1.67, AJBR=1.26
DEBUG: on_demand run: 122 bleed transitions, 92 joint bleed transitions, ABR=1.67, AJBR=1.26
DEBUG: on_demand run: 122 bleed transitions, 92 joint bleed transitions, ABR=1.67, AJBR=1.26
DEBUG: on_demand run: 100 bleed transitions, 79 joint bleed transitions, ABR=1.37, AJBR=1.08
DEBUG: on_demand run: 100 bleed transitions, 79 joint bleed transitions, ABR=1.37, AJBR=1.08
DEBUG: on_demand run: 100 bleed transitions, 79 joint bleed transitions, ABR=1.37, AJBR=1.08
DEBUG: on_demand run: 100 bleed transitions, 79 joint bleed transitions, ABR=1.37, AJBR=1.08
DEBUG: on_demand run: 48 bleed transitions, 40 joint bleed transitions, ABR=0.66, AJBR=0.55
DEBUG: on_demand run: 48 bleed transitions, 40 joint bleed transitions, ABR=0.66, AJBR=0.55
DEBUG: on_demand run: 48 bleed transitions, 40 joint bleed transitions, ABR=0.66, AJBR=0.55
DEBUG: on_demand run: 48 bleed transitions, 40 joint bleed transitions, ABR=0.66, AJBR=0.55
DEBUG: on_demand run: 136 bleed transitions, 107 joint bleed transitions, ABR=1.86, AJBR=1.47
DEBUG: on_demand run: 136 bleed transitions, 107 joint bleed transitions, ABR=1.86, AJBR=1.47
DEBUG: on_demand run: 136 bleed transitions, 107 joint bleed transitions, ABR=1.86, AJBR=1.47
DEBUG: on_demand run: 136 bleed transitions, 107 joint bleed transitions, ABR=1.86, AJBR=1.47
DEBUG: on_demand run: 132 bleed transitions, 104 joint bleed transitions, ABR=1.81, AJBR=1.42
DEBUG: on_demand run: 132 bleed transitions, 104 joint bleed transitions, ABR=1.81, AJBR=1.42
DEBUG: on_demand run: 132 bleed transitions, 104 joint bleed transitions, ABR=1.81, AJBR=1.42
DEBUG: on_demand run: 132 bleed transitions, 104 joint bleed transitions, ABR=1.81, AJBR=1.42
DEBUG: on_demand run: 95 bleed transitions, 70 joint bleed transitions, ABR=1.30, AJBR=0.96
DEBUG: on_demand run: 95 bleed transitions, 70 joint bleed transitions, ABR=1.30, AJBR=0.96
DEBUG: on_demand run: 95 bleed transitions, 70 joint bleed transitions, ABR=1.30, AJBR=0.96
DEBUG: on_demand run: 95 bleed transitions, 70 joint bleed transitions, ABR=1.30, AJBR=0.96
DEBUG: on_demand run: 354 bleed transitions, 282 joint bleed transitions, ABR=4.85, AJBR=3.86
DEBUG: on_demand run: 354 bleed transitions, 282 joint bleed transitions, ABR=4.85, AJBR=3.86
DEBUG: on_demand run: 354 bleed transitions, 282 joint bleed transitions, ABR=4.85, AJBR=3.86
DEBUG: on_demand run: 354 bleed transitions, 282 joint bleed transitions, ABR=4.85, AJBR=3.86
DEBUG: on_demand run: 734 bleed transitions, 592 joint bleed transitions, ABR=10.05, AJBR=8.11
DEBUG: on_demand run: 734 bleed transitions, 592 joint bleed transitions, ABR=10.05, AJBR=8.11
DEBUG: on_demand run: 734 bleed transitions, 592 joint bleed transitions, ABR=10.05, AJBR=8.11
DEBUG: on_demand run: 734 bleed transitions, 592 joint bleed transitions, ABR=10.05, AJBR=8.11
DEBUG: on_demand run: 174 bleed transitions, 135 joint bleed transitions, ABR=2.38, AJBR=1.85
DEBUG: on_demand run: 174 bleed transitions, 135 joint bleed transitions, ABR=2.38, AJBR=1.85
DEBUG: on_demand run: 174 bleed transitions, 135 joint bleed transitions, ABR=2.38, AJBR=1.85
DEBUG: on_demand run: 174 bleed transitions, 135 joint bleed transitions, ABR=2.38, AJBR=1.85
DEBUG: on_demand run: 266 bleed transitions, 216 joint bleed transitions, ABR=3.64, AJBR=2.96
DEBUG: on_demand run: 266 bleed transitions, 216 joint bleed transitions, ABR=3.64, AJBR=2.96
DEBUG: on_demand run: 266 bleed transitions, 216 joint bleed transitions, ABR=3.64, AJBR=2.96
DEBUG: on_demand run: 266 bleed transitions, 216 joint bleed transitions, ABR=3.64, AJBR=2.96
DEBUG: on_demand run: 136 bleed transitions, 110 joint bleed transitions, ABR=1.86, AJBR=1.51
DEBUG: on_demand run: 136 bleed transitions, 110 joint bleed transitions, ABR=1.86, AJBR=1.51
DEBUG: on_demand run: 136 bleed transitions, 110 joint bleed transitions, ABR=1.86, AJBR=1.51
DEBUG: on_demand run: 136 bleed transitions, 110 joint bleed transitions, ABR=1.86, AJBR=1.51
DEBUG: on_demand run: 95 bleed transitions, 72 joint bleed transitions, ABR=1.30, AJBR=0.99
DEBUG: on_demand run: 95 bleed transitions, 72 joint bleed transitions, ABR=1.30, AJBR=0.99
DEBUG: on_demand run: 95 bleed transitions, 72 joint bleed transitions, ABR=1.30, AJBR=0.99
DEBUG: on_demand run: 95 bleed transitions, 72 joint bleed transitions, ABR=1.30, AJBR=0.99
DEBUG: on_demand run: 145 bleed transitions, 120 joint bleed transitions, ABR=1.99, AJBR=1.64
DEBUG: on_demand run: 145 bleed transitions, 120 joint bleed transitions, ABR=1.99, AJBR=1.64
DEBUG: on_demand run: 145 bleed transitions, 120 joint bleed transitions, ABR=1.99, AJBR=1.64
DEBUG: on_demand run: 145 bleed transitions, 120 joint bleed transitions, ABR=1.99, AJBR=1.64
DEBUG: on_demand run: 300 bleed transitions, 234 joint bleed transitions, ABR=4.11, AJBR=3.21
DEBUG: on_demand run: 300 bleed transitions, 234 joint bleed transitions, ABR=4.11, AJBR=3.21
DEBUG: on_demand run: 300 bleed transitions, 234 joint bleed transitions, ABR=4.11, AJBR=3.21
DEBUG: on_demand run: 300 bleed transitions, 234 joint bleed transitions, ABR=4.11, AJBR=3.21
DEBUG: on_demand run: 189 bleed transitions, 148 joint bleed transitions, ABR=2.59, AJBR=2.03
DEBUG: on_demand run: 189 bleed transitions, 148 joint bleed transitions, ABR=2.59, AJBR=2.03
DEBUG: on_demand run: 189 bleed transitions, 148 joint bleed transitions, ABR=2.59, AJBR=2.03
DEBUG: on_demand run: 189 bleed transitions, 148 joint bleed transitions, ABR=2.59, AJBR=2.03
DEBUG: on_demand run: 93 bleed transitions, 75 joint bleed transitions, ABR=1.27, AJBR=1.03
DEBUG: on_demand run: 93 bleed transitions, 75 joint bleed transitions, ABR=1.27, AJBR=1.03
DEBUG: on_demand run: 93 bleed transitions, 75 joint bleed transitions, ABR=1.27, AJBR=1.03
DEBUG: on_demand run: 93 bleed transitions, 75 joint bleed transitions, ABR=1.27, AJBR=1.03
INFO: on_demand: Expected ABR=44.00, Simulated ABR=2.38, Expected AJBR=34.00, Simulated AJBR=1.89
INFO: on_demand early: Average ABR over 73.00 years: 2.38 bleeds/year, Average AJBR: 1.89 joint bleeds/year
INFO: on_demand early: Average total factor VIII dose over 73.00 years: 6077320.48 IU, Average total cost: 352484696856.63 Rial
DEBUG: on_demand early Week 0, Age 0.00 years, State: alive_wo_arthropathy, Dose: 0.00 IU, Cost: 0.00 Rial
DEBUG: on_demand early Week 1, Age 0.02 years, State: life_treating_bleeding, Dose: 403.67 IU, Cost: 23412666.67 Rial
DEBUG: on_demand early Week 2, Age 0.04 years, State: alive_wo_arthropathy, Dose: 0.00 IU, Cost: 0.00 Rial
DEBUG: on_demand early Week 3, Age 0.06 years, State: life_treating_bleeding, Dose: 403.67 IU, Cost: 23412666.67 Rial
DEBUG: on_demand early Week 4, Age 0.08 years, State: alive_wo_arthropathy, Dose: 0.00 IU, Cost: 0.00 Rial
INFO: Creating new transition matrix at: data/processed/od_intermediate_transition_matrix.csv
WARNING: on_demand chronic_arthropathy row sum 1.4785 > 1, normalizing
DEBUG: on_demand inhibitor row sum 0.0000 < 1, adding to inhibitor
WARNING: on_demand severe_arthropathy row sum 1.4781 > 1, normalizing
DEBUG: on_demand transition probabilities from chronic_arthropathy:
DEBUG:   To minor_bleeding: 0.1545
DEBUG:   To articular_bleeding: 0.7960
DEBUG:   To life_treating_bleeding: 0.0464
DEBUG:   To inhibitor: 0.0028
DEBUG:   To severe_arthropathy: 0.0003
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from minor_bleeding:
DEBUG:   To inhibitor: 0.0041
DEBUG:   Row sum: 0.0041
DEBUG: on_demand transition probabilities from articular_bleeding:
DEBUG:   To chronic_arthropathy: 0.0004
DEBUG:   To inhibitor: 0.0041
DEBUG:   Row sum: 0.0046
DEBUG: on_demand transition probabilities from life_treating_bleeding:
DEBUG:   To inhibitor: 0.0041
DEBUG:   To death: 0.0000
DEBUG:   Row sum: 0.0042
DEBUG: on_demand transition probabilities from surgery:
DEBUG:   To inhibitor: 0.0041
DEBUG:   Row sum: 0.0041
DEBUG: on_demand transition probabilities from inhibitor:
DEBUG:   To inhibitor: 1.0000
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from death:
DEBUG:   To death: 1.0000
DEBUG:   Row sum: 1.0000
DEBUG: on_demand transition probabilities from severe_arthropathy:
DEBUG:   To minor_bleeding: 0.1546
DEBUG:   To articular_bleeding: 0.7963
DEBUG:   To life_treating_bleeding: 0.0464
DEBUG:   To inhibitor: 0.0028
DEBUG:   Row sum: 1.0000
INFO: Saving on_demand transition matrix
